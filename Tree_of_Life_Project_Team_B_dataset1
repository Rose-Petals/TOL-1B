{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "6b350c67-8a35-4e2c-99a3-cf6b38d29fc0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>INTAKE METHOD</th>\n",
       "      <th>REFERENCES</th>\n",
       "      <th>Please be specific on who sent you our way, we'd like to thank them.</th>\n",
       "      <th>AGE</th>\n",
       "      <th>TOWN</th>\n",
       "      <th>INSURANCE CARRIER</th>\n",
       "      <th>APPOINTMENT LOCATION</th>\n",
       "      <th>APPOINTMENT TYPE</th>\n",
       "      <th>If Talk Therapy, specifically what type?</th>\n",
       "      <th>Appointment Time</th>\n",
       "      <th>...</th>\n",
       "      <th>Unnamed: 17</th>\n",
       "      <th>Unnamed: 18</th>\n",
       "      <th>Unnamed: 19</th>\n",
       "      <th>Unnamed: 20</th>\n",
       "      <th>Unnamed: 21</th>\n",
       "      <th>Unnamed: 22</th>\n",
       "      <th>Unnamed: 23</th>\n",
       "      <th>Unnamed: 24</th>\n",
       "      <th>Unnamed: 25</th>\n",
       "      <th>Unnamed: 26</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Call</td>\n",
       "      <td>Bariatric Doctor</td>\n",
       "      <td>Bariatric Doctor</td>\n",
       "      <td>25-30</td>\n",
       "      <td>Elizabeth</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Virtual</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Bariatric Evaluation</td>\n",
       "      <td>Evening (4-8)</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Call</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>Mom</td>\n",
       "      <td>10-15</td>\n",
       "      <td>Summit</td>\n",
       "      <td>United Healthcare</td>\n",
       "      <td>Virtual</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (minor)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>Friend</td>\n",
       "      <td>20-25</td>\n",
       "      <td>Monroe</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (adult)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>NaN</td>\n",
       "      <td>25-30</td>\n",
       "      <td>Ocean</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (adult)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>NaN</td>\n",
       "      <td>30-35</td>\n",
       "      <td>Jackson</td>\n",
       "      <td>Aetna</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (adult)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 27 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "  INTAKE METHOD        REFERENCES  \\\n",
       "0          Call  Bariatric Doctor   \n",
       "1          Call     Family/Friend   \n",
       "2     Boom Form     Family/Friend   \n",
       "3     Boom Form     Family/Friend   \n",
       "4     Boom Form     Family/Friend   \n",
       "\n",
       "  Please be specific on who sent you our way, we'd like to thank them.   \\\n",
       "0                                   Bariatric Doctor                      \n",
       "1                                                Mom                      \n",
       "2                                             Friend                      \n",
       "3                                                NaN                      \n",
       "4                                                NaN                      \n",
       "\n",
       "     AGE       TOWN  INSURANCE CARRIER APPOINTMENT LOCATION APPOINTMENT TYPE  \\\n",
       "0  25-30  Elizabeth               BCBS              Virtual     Talk Therapy   \n",
       "1  10-15     Summit  United Healthcare              Virtual     Talk Therapy   \n",
       "2  20-25     Monroe               BCBS             Freehold     Talk Therapy   \n",
       "3  25-30      Ocean               BCBS             Freehold     Talk Therapy   \n",
       "4  30-35    Jackson              Aetna             Freehold     Talk Therapy   \n",
       "\n",
       "  If Talk Therapy, specifically what type?  Appointment Time  ... Unnamed: 17  \\\n",
       "0                     Bariatric Evaluation     Evening (4-8)  ...         NaN   \n",
       "1                       Individual (minor)  Afternoon (12-4)  ...         NaN   \n",
       "2                       Individual (adult)  Afternoon (12-4)  ...         NaN   \n",
       "3                       Individual (adult)  Afternoon (12-4)  ...         NaN   \n",
       "4                       Individual (adult)  Afternoon (12-4)  ...         NaN   \n",
       "\n",
       "   Unnamed: 18  Unnamed: 19  Unnamed: 20  Unnamed: 21  Unnamed: 22  \\\n",
       "0          NaN          NaN          NaN          NaN          NaN   \n",
       "1          NaN          NaN          NaN          NaN          NaN   \n",
       "2          NaN          NaN          NaN          NaN          NaN   \n",
       "3          NaN          NaN          NaN          NaN          NaN   \n",
       "4          NaN          NaN          NaN          NaN          NaN   \n",
       "\n",
       "   Unnamed: 23  Unnamed: 24  Unnamed: 25  Unnamed: 26  \n",
       "0          NaN          NaN          NaN          NaN  \n",
       "1          NaN          NaN          NaN          NaN  \n",
       "2          NaN          NaN          NaN          NaN  \n",
       "3          NaN          NaN          NaN          NaN  \n",
       "4          NaN          NaN          NaN          NaN  \n",
       "\n",
       "[5 rows x 27 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "url = \"https://raw.githubusercontent.com/Rose-Petals/TOL-1B/refs/heads/main/TOLCC%20Break%20Through%20Tech%20Dataset%20(1).csv\"\n",
    "\n",
    "df = pd.read_csv(url)\n",
    "(df.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "b3bf08a7-3a55-4536-b0ad-447ff30e4926",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>INTAKE METHOD</th>\n",
       "      <th>REFERENCES</th>\n",
       "      <th>Please be specific on who sent you our way, we'd like to thank them.</th>\n",
       "      <th>AGE</th>\n",
       "      <th>TOWN</th>\n",
       "      <th>INSURANCE CARRIER</th>\n",
       "      <th>APPOINTMENT LOCATION</th>\n",
       "      <th>APPOINTMENT TYPE</th>\n",
       "      <th>If Talk Therapy, specifically what type?</th>\n",
       "      <th>Appointment Time</th>\n",
       "      <th>Unnamed: 10</th>\n",
       "      <th>Unnamed: 11</th>\n",
       "      <th>Unnamed: 12</th>\n",
       "      <th>Unnamed: 13</th>\n",
       "      <th>Unnamed: 14</th>\n",
       "      <th>Unnamed: 15</th>\n",
       "      <th>Unnamed: 16</th>\n",
       "      <th>Unnamed: 17</th>\n",
       "      <th>Unnamed: 18</th>\n",
       "      <th>Unnamed: 19</th>\n",
       "      <th>Unnamed: 20</th>\n",
       "      <th>Unnamed: 21</th>\n",
       "      <th>Unnamed: 22</th>\n",
       "      <th>Unnamed: 23</th>\n",
       "      <th>Unnamed: 24</th>\n",
       "      <th>Unnamed: 25</th>\n",
       "      <th>Unnamed: 26</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Call</td>\n",
       "      <td>Bariatric Doctor</td>\n",
       "      <td>Bariatric Doctor</td>\n",
       "      <td>25-30</td>\n",
       "      <td>Elizabeth</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Virtual</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Bariatric Evaluation</td>\n",
       "      <td>Evening (4-8)</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Call</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>Mom</td>\n",
       "      <td>10-15</td>\n",
       "      <td>Summit</td>\n",
       "      <td>United Healthcare</td>\n",
       "      <td>Virtual</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (minor)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>Friend</td>\n",
       "      <td>20-25</td>\n",
       "      <td>Monroe</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (adult)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>NaN</td>\n",
       "      <td>25-30</td>\n",
       "      <td>Ocean</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (adult)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>NaN</td>\n",
       "      <td>30-35</td>\n",
       "      <td>Jackson</td>\n",
       "      <td>Aetna</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (adult)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  INTAKE METHOD        REFERENCES  \\\n",
       "0          Call  Bariatric Doctor   \n",
       "1          Call     Family/Friend   \n",
       "2     Boom Form     Family/Friend   \n",
       "3     Boom Form     Family/Friend   \n",
       "4     Boom Form     Family/Friend   \n",
       "\n",
       "  Please be specific on who sent you our way, we'd like to thank them.   \\\n",
       "0                                   Bariatric Doctor                      \n",
       "1                                                Mom                      \n",
       "2                                             Friend                      \n",
       "3                                                NaN                      \n",
       "4                                                NaN                      \n",
       "\n",
       "     AGE       TOWN  INSURANCE CARRIER APPOINTMENT LOCATION APPOINTMENT TYPE  \\\n",
       "0  25-30  Elizabeth               BCBS              Virtual     Talk Therapy   \n",
       "1  10-15     Summit  United Healthcare              Virtual     Talk Therapy   \n",
       "2  20-25     Monroe               BCBS             Freehold     Talk Therapy   \n",
       "3  25-30      Ocean               BCBS             Freehold     Talk Therapy   \n",
       "4  30-35    Jackson              Aetna             Freehold     Talk Therapy   \n",
       "\n",
       "  If Talk Therapy, specifically what type?  Appointment Time Unnamed: 10  \\\n",
       "0                     Bariatric Evaluation     Evening (4-8)         NaN   \n",
       "1                       Individual (minor)  Afternoon (12-4)         NaN   \n",
       "2                       Individual (adult)  Afternoon (12-4)         NaN   \n",
       "3                       Individual (adult)  Afternoon (12-4)         NaN   \n",
       "4                       Individual (adult)  Afternoon (12-4)         NaN   \n",
       "\n",
       "   Unnamed: 11  Unnamed: 12  Unnamed: 13  Unnamed: 14  Unnamed: 15  \\\n",
       "0          NaN          NaN          NaN          NaN          NaN   \n",
       "1          NaN          NaN          NaN          NaN          NaN   \n",
       "2          NaN          NaN          NaN          NaN          NaN   \n",
       "3          NaN          NaN          NaN          NaN          NaN   \n",
       "4          NaN          NaN          NaN          NaN          NaN   \n",
       "\n",
       "   Unnamed: 16  Unnamed: 17  Unnamed: 18  Unnamed: 19  Unnamed: 20  \\\n",
       "0          NaN          NaN          NaN          NaN          NaN   \n",
       "1          NaN          NaN          NaN          NaN          NaN   \n",
       "2          NaN          NaN          NaN          NaN          NaN   \n",
       "3          NaN          NaN          NaN          NaN          NaN   \n",
       "4          NaN          NaN          NaN          NaN          NaN   \n",
       "\n",
       "   Unnamed: 21  Unnamed: 22  Unnamed: 23  Unnamed: 24  Unnamed: 25  \\\n",
       "0          NaN          NaN          NaN          NaN          NaN   \n",
       "1          NaN          NaN          NaN          NaN          NaN   \n",
       "2          NaN          NaN          NaN          NaN          NaN   \n",
       "3          NaN          NaN          NaN          NaN          NaN   \n",
       "4          NaN          NaN          NaN          NaN          NaN   \n",
       "\n",
       "   Unnamed: 26  \n",
       "0          NaN  \n",
       "1          NaN  \n",
       "2          NaN  \n",
       "3          NaN  \n",
       "4          NaN  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.set_option(\"display.max_columns\", None) ##displays all 27 columns\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "512745c4-3f25-479e-8646-6b1dbf288989",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['INTAKE METHOD', ' REFERENCES', \"Please be specific on who sent you our way, we'd like to thank them. \", 'AGE', 'TOWN', 'INSURANCE CARRIER', 'APPOINTMENT LOCATION', 'APPOINTMENT TYPE', 'If Talk Therapy, specifically what type?', 'Appointment Time', 'Unnamed: 10', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']\n"
     ]
    }
   ],
   "source": [
    "print(df.columns.tolist())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "5422c6bb-a725-498f-9c22-e02ab8f3eee2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Unnamed: 10\n",
       "NaN                     1031\n",
       "Submitted Form             1\n",
       "503                        1\n",
       "Start Talk Therapy         1\n",
       "Start Med Management       1\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[\"Unnamed: 10\"].value_counts(dropna=False) ##includes NaN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "4ebccc81-63fa-4ccd-8c28-5c30a931ee0d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Unnamed: 11\n",
       "NaN      1032\n",
       "220.0       1\n",
       "378.0       1\n",
       "75.0        1\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[\"Unnamed: 11\"].value_counts(dropna=False) ##includes NaN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "c2124a77-53cc-4bd8-9b6c-59ec0becb61c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Unnamed: 12\n",
       "NaN    1035\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[\"Unnamed: 12\"].value_counts(dropna=False) ##includes NaN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "25c0768c-746a-46a9-90d3-fd6ee0755759",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', 'Unnamed: 15',\n",
      "       'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', 'Unnamed: 19',\n",
      "       'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', 'Unnamed: 23',\n",
      "       'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26'],\n",
      "      dtype='object')\n"
     ]
    }
   ],
   "source": [
    "empty_cols = df.columns[df.isna().all()]  #checks which columns have all NaN in each\n",
    "print(empty_cols)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "3c04ffa1-7f0f-4e9c-ac2f-4a907d581903",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = df.dropna(axis=1, how=\"all\") ##dropping columns w/ all NaN in each"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "b7fec685-9cdd-4c59-aec6-54acda276ec7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>INTAKE METHOD</th>\n",
       "      <th>REFERENCES</th>\n",
       "      <th>Please be specific on who sent you our way, we'd like to thank them.</th>\n",
       "      <th>AGE</th>\n",
       "      <th>TOWN</th>\n",
       "      <th>INSURANCE CARRIER</th>\n",
       "      <th>APPOINTMENT LOCATION</th>\n",
       "      <th>APPOINTMENT TYPE</th>\n",
       "      <th>If Talk Therapy, specifically what type?</th>\n",
       "      <th>Appointment Time</th>\n",
       "      <th>Unnamed: 10</th>\n",
       "      <th>Unnamed: 11</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Call</td>\n",
       "      <td>Bariatric Doctor</td>\n",
       "      <td>Bariatric Doctor</td>\n",
       "      <td>25-30</td>\n",
       "      <td>Elizabeth</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Virtual</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Bariatric Evaluation</td>\n",
       "      <td>Evening (4-8)</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Call</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>Mom</td>\n",
       "      <td>10-15</td>\n",
       "      <td>Summit</td>\n",
       "      <td>United Healthcare</td>\n",
       "      <td>Virtual</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (minor)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>Friend</td>\n",
       "      <td>20-25</td>\n",
       "      <td>Monroe</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (adult)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>NaN</td>\n",
       "      <td>25-30</td>\n",
       "      <td>Ocean</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (adult)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>NaN</td>\n",
       "      <td>30-35</td>\n",
       "      <td>Jackson</td>\n",
       "      <td>Aetna</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (adult)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  INTAKE METHOD        REFERENCES  \\\n",
       "0          Call  Bariatric Doctor   \n",
       "1          Call     Family/Friend   \n",
       "2     Boom Form     Family/Friend   \n",
       "3     Boom Form     Family/Friend   \n",
       "4     Boom Form     Family/Friend   \n",
       "\n",
       "  Please be specific on who sent you our way, we'd like to thank them.   \\\n",
       "0                                   Bariatric Doctor                      \n",
       "1                                                Mom                      \n",
       "2                                             Friend                      \n",
       "3                                                NaN                      \n",
       "4                                                NaN                      \n",
       "\n",
       "     AGE       TOWN  INSURANCE CARRIER APPOINTMENT LOCATION APPOINTMENT TYPE  \\\n",
       "0  25-30  Elizabeth               BCBS              Virtual     Talk Therapy   \n",
       "1  10-15     Summit  United Healthcare              Virtual     Talk Therapy   \n",
       "2  20-25     Monroe               BCBS             Freehold     Talk Therapy   \n",
       "3  25-30      Ocean               BCBS             Freehold     Talk Therapy   \n",
       "4  30-35    Jackson              Aetna             Freehold     Talk Therapy   \n",
       "\n",
       "  If Talk Therapy, specifically what type?  Appointment Time Unnamed: 10  \\\n",
       "0                     Bariatric Evaluation     Evening (4-8)         NaN   \n",
       "1                       Individual (minor)  Afternoon (12-4)         NaN   \n",
       "2                       Individual (adult)  Afternoon (12-4)         NaN   \n",
       "3                       Individual (adult)  Afternoon (12-4)         NaN   \n",
       "4                       Individual (adult)  Afternoon (12-4)         NaN   \n",
       "\n",
       "   Unnamed: 11  \n",
       "0          NaN  \n",
       "1          NaN  \n",
       "2          NaN  \n",
       "3          NaN  \n",
       "4          NaN  "
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.set_option(\"display.max_columns\", None) ##displays all 27 columns\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "4cdc453a-ccd6-4190-9d81-ff53a50b5432",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['intake_method', 'references', \"please_be_specific_on_who_sent_you_our_way,_we'd_like_to_thank_them.\", 'age', 'town', 'insurance_carrier', 'appointment_location', 'appointment_type', 'if_talk_therapy,_specifically_what_type?', 'appointment_time', 'unnamed:_10', 'unnamed:_11']\n"
     ]
    }
   ],
   "source": [
    "df.columns = df.columns.str.strip().str.lower().str.replace(\" \", \"_\")  #standardizing column names\n",
    "print(df.columns.tolist())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "c58c7285-c783-46ab-9d5c-2ac4420dc453",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>intake_method</th>\n",
       "      <th>referer</th>\n",
       "      <th>age</th>\n",
       "      <th>town</th>\n",
       "      <th>insurance_carrier</th>\n",
       "      <th>appointment_location</th>\n",
       "      <th>appointment_type</th>\n",
       "      <th>talk_therapy_type</th>\n",
       "      <th>appointment_time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Call</td>\n",
       "      <td>Bariatric Doctor</td>\n",
       "      <td>25-30</td>\n",
       "      <td>Elizabeth</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Virtual</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Bariatric Evaluation</td>\n",
       "      <td>Evening (4-8)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Call</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>10-15</td>\n",
       "      <td>Summit</td>\n",
       "      <td>United Healthcare</td>\n",
       "      <td>Virtual</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (minor)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>20-25</td>\n",
       "      <td>Monroe</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (adult)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>25-30</td>\n",
       "      <td>Ocean</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (adult)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>30-35</td>\n",
       "      <td>Jackson</td>\n",
       "      <td>Aetna</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual (adult)</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  intake_method           referer    age       town  insurance_carrier  \\\n",
       "0          Call  Bariatric Doctor  25-30  Elizabeth               BCBS   \n",
       "1          Call     Family/Friend  10-15     Summit  United Healthcare   \n",
       "2     Boom Form     Family/Friend  20-25     Monroe               BCBS   \n",
       "3     Boom Form     Family/Friend  25-30      Ocean               BCBS   \n",
       "4     Boom Form     Family/Friend  30-35    Jackson              Aetna   \n",
       "\n",
       "  appointment_location appointment_type     talk_therapy_type  \\\n",
       "0              Virtual     Talk Therapy  Bariatric Evaluation   \n",
       "1              Virtual     Talk Therapy    Individual (minor)   \n",
       "2             Freehold     Talk Therapy    Individual (adult)   \n",
       "3             Freehold     Talk Therapy    Individual (adult)   \n",
       "4             Freehold     Talk Therapy    Individual (adult)   \n",
       "\n",
       "   appointment_time  \n",
       "0     Evening (4-8)  \n",
       "1  Afternoon (12-4)  \n",
       "2  Afternoon (12-4)  \n",
       "3  Afternoon (12-4)  \n",
       "4  Afternoon (12-4)  "
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.rename(columns={'if_talk_therapy,_specifically_what_type?': 'talk_therapy_type', 'references' : 'referer'}, inplace=True)\n",
    "df.drop(columns= {\"please_be_specific_on_who_sent_you_our_way,_we'd_like_to_thank_them.\", \"unnamed:_10\", \"unnamed:_11\"}, inplace=True)\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "0d927932-2f6d-4492-97f6-e5e6bf0ecee6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "talk_therapy_type\n",
       "Individual (adult)      593\n",
       "Individual (minor)      248\n",
       "NaN                     105\n",
       "Couples                  57\n",
       "â€‹                        18\n",
       "Family                    8\n",
       "Bariatric Evaluation      6\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['talk_therapy_type'].value_counts(dropna=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "10074113-ca5c-4342-b4c1-139e0f1bf6d9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['Bariatric Evaluation', 'Individual (minor)', 'Individual (adult)',\n",
       "       nan, 'Couples', 'Family', '\\u200b'], dtype=object)"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['talk_therapy_type'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "id": "a732d434-be22-40eb-85d6-50f01c215bb4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "talk_therapy_type\n",
       "Individual (adult)      593\n",
       "Individual (minor)      248\n",
       "NaN                     123\n",
       "Couples                  57\n",
       "Family                    8\n",
       "Bariatric Evaluation      6\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 65,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['talk_therapy_type'] = df['talk_therapy_type'].replace('\\u200b', np.nan) #remove 18 hidden character row values w/ NaN\n",
    "df['talk_therapy_type'].value_counts(dropna=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "id": "f492b013-d0c3-4570-9288-a7958e8c21c2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "talk_therapy_type\n",
       "Individual              841\n",
       "NaN                     123\n",
       "Couples                  57\n",
       "Family                    8\n",
       "Bariatric Evaluation      6\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 71,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['talk_therapy_type'] = df['talk_therapy_type'].replace('Individual (minor)', 'Individual')\n",
    "df['talk_therapy_type'] = df['talk_therapy_type'].replace('Individual (adult)', 'Individual')\n",
    "df['talk_therapy_type'].value_counts(dropna=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "id": "986dc8e5-0def-41fb-b6f7-4d9b6462216d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0       27.5\n",
      "1       12.5\n",
      "2       22.5\n",
      "3       27.5\n",
      "4       32.5\n",
      "        ... \n",
      "1030     7.5\n",
      "1031    12.5\n",
      "1032    17.5\n",
      "1033    42.5\n",
      "1034    22.5\n",
      "Name: age, Length: 1035, dtype: float64\n"
     ]
    }
   ],
   "source": [
    "def average_age(cell):   ##function to average out age instead of having it as a range like 15-20\n",
    "    if pd.isna(cell):\n",
    "        return np.nan\n",
    "    values = str(cell).replace('-', ',').split(',')\n",
    "    nums = []\n",
    "    for val in values:\n",
    "        val = val.strip()\n",
    "        try:\n",
    "            nums.append(float(val))\n",
    "        except ValueError:\n",
    "            continue\n",
    "    if not nums:\n",
    "        return np.nan\n",
    "    return sum(nums) / len(nums)\n",
    "df['age'] = df['age'].apply(average_age)\n",
    "print(df['age'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "id": "c7b461b8-b857-4a4a-bd30-90b6041d47f6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>intake_method</th>\n",
       "      <th>referer</th>\n",
       "      <th>age</th>\n",
       "      <th>town</th>\n",
       "      <th>insurance_carrier</th>\n",
       "      <th>appointment_location</th>\n",
       "      <th>appointment_type</th>\n",
       "      <th>talk_therapy_type</th>\n",
       "      <th>appointment_time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Call</td>\n",
       "      <td>Bariatric Doctor</td>\n",
       "      <td>27.5</td>\n",
       "      <td>Elizabeth</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Virtual</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Bariatric Evaluation</td>\n",
       "      <td>Evening (4-8)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Call</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>12.5</td>\n",
       "      <td>Summit</td>\n",
       "      <td>United Healthcare</td>\n",
       "      <td>Virtual</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>22.5</td>\n",
       "      <td>Monroe</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>27.5</td>\n",
       "      <td>Ocean</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>32.5</td>\n",
       "      <td>Jackson</td>\n",
       "      <td>Aetna</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual</td>\n",
       "      <td>Afternoon (12-4)</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  intake_method           referer   age       town  insurance_carrier  \\\n",
       "0          Call  Bariatric Doctor  27.5  Elizabeth               BCBS   \n",
       "1          Call     Family/Friend  12.5     Summit  United Healthcare   \n",
       "2     Boom Form     Family/Friend  22.5     Monroe               BCBS   \n",
       "3     Boom Form     Family/Friend  27.5      Ocean               BCBS   \n",
       "4     Boom Form     Family/Friend  32.5    Jackson              Aetna   \n",
       "\n",
       "  appointment_location appointment_type     talk_therapy_type  \\\n",
       "0              Virtual     Talk Therapy  Bariatric Evaluation   \n",
       "1              Virtual     Talk Therapy            Individual   \n",
       "2             Freehold     Talk Therapy            Individual   \n",
       "3             Freehold     Talk Therapy            Individual   \n",
       "4             Freehold     Talk Therapy            Individual   \n",
       "\n",
       "   appointment_time  \n",
       "0     Evening (4-8)  \n",
       "1  Afternoon (12-4)  \n",
       "2  Afternoon (12-4)  \n",
       "3  Afternoon (12-4)  \n",
       "4  Afternoon (12-4)  "
      ]
     },
     "execution_count": 75,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "id": "c9f69c16-ef25-4aa7-a48b-ee9090b8bac1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([27.5, 12.5, 22.5, 32.5,  nan, 17.5, 62.5, 42.5,  3. ,  7.5, 52.5,\n",
       "       57.5, 37.5, 67.5, 50. , 30. , 45. , 77.5, 72.5, 82.5, 87.5, 40. ,\n",
       "       47.5, 60. , 55. , 35. , 25. ])"
      ]
     },
     "execution_count": 77,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['age'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "id": "4c313541-e4b1-4023-8dd0-e76c1d7436ef",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "appointment_time\n",
       "Evening      397\n",
       "Afternoon    397\n",
       "Morning      240\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 79,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['appointment_time'].value_counts()\n",
    "df['appointment_time'] = df['appointment_time'].replace('Evening (4-8)' , 'Evening')\n",
    "df['appointment_time'] = df['appointment_time'].replace('Afternoon (12-4)' , 'Afternoon')\n",
    "df['appointment_time'] = df['appointment_time'].replace('Morning (9-12)' , 'Morning')\n",
    "df['appointment_time'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "id": "2dfb5fc8-8e9a-4590-8dbe-13df87c88cee",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "intake_method             0\n",
       "referer                   2\n",
       "age                       6\n",
       "town                      4\n",
       "insurance_carrier         2\n",
       "appointment_location      1\n",
       "appointment_type          1\n",
       "talk_therapy_type       123\n",
       "appointment_time          1\n",
       "dtype: int64"
      ]
     },
     "execution_count": 81,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "id": "5c3a118c-cb1e-4682-a472-368cfb667489",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.dropna(subset = ['appointment_time'], inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "id": "395c2671-2d02-4918-b976-9c4034124d7a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "intake_method             0\n",
       "referer                   2\n",
       "age                       6\n",
       "town                      4\n",
       "insurance_carrier         2\n",
       "appointment_location      0\n",
       "appointment_type          0\n",
       "talk_therapy_type       122\n",
       "appointment_time          0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 85,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "id": "45e1cc0a-3a86-41c9-89c5-b9aa9ee9e0d0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "intake_method             0\n",
       "referer                   0\n",
       "age                       0\n",
       "town                      0\n",
       "insurance_carrier         0\n",
       "appointment_location      0\n",
       "appointment_type          0\n",
       "talk_therapy_type       122\n",
       "appointment_time          0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 92,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.fillna({'age': df['age'].mean(), 'referer': 'Unknown', 'town' : 'Unknown', 'insurance_carrier' : 'Unknown'}, inplace=True)\n",
    "df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "id": "66bef58e-1dd6-4530-b772-d0bdf7de1b94",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>intake_method</th>\n",
       "      <th>referer</th>\n",
       "      <th>age</th>\n",
       "      <th>town</th>\n",
       "      <th>insurance_carrier</th>\n",
       "      <th>appointment_location</th>\n",
       "      <th>appointment_type</th>\n",
       "      <th>talk_therapy_type</th>\n",
       "      <th>appointment_time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Call</td>\n",
       "      <td>Bariatric Doctor</td>\n",
       "      <td>27.5</td>\n",
       "      <td>Elizabeth</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Virtual</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Bariatric Evaluation</td>\n",
       "      <td>Evening</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Call</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>12.5</td>\n",
       "      <td>Summit</td>\n",
       "      <td>United Healthcare</td>\n",
       "      <td>Virtual</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual</td>\n",
       "      <td>Afternoon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>22.5</td>\n",
       "      <td>Monroe</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual</td>\n",
       "      <td>Afternoon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>27.5</td>\n",
       "      <td>Ocean</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual</td>\n",
       "      <td>Afternoon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>32.5</td>\n",
       "      <td>Jackson</td>\n",
       "      <td>Aetna</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Talk Therapy</td>\n",
       "      <td>Individual</td>\n",
       "      <td>Afternoon</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  intake_method           referer   age       town  insurance_carrier  \\\n",
       "0          Call  Bariatric Doctor  27.5  Elizabeth               BCBS   \n",
       "1          Call     Family/Friend  12.5     Summit  United Healthcare   \n",
       "2     Boom Form     Family/Friend  22.5     Monroe               BCBS   \n",
       "3     Boom Form     Family/Friend  27.5      Ocean               BCBS   \n",
       "4     Boom Form     Family/Friend  32.5    Jackson              Aetna   \n",
       "\n",
       "  appointment_location appointment_type     talk_therapy_type appointment_time  \n",
       "0              Virtual     Talk Therapy  Bariatric Evaluation          Evening  \n",
       "1              Virtual     Talk Therapy            Individual        Afternoon  \n",
       "2             Freehold     Talk Therapy            Individual        Afternoon  \n",
       "3             Freehold     Talk Therapy            Individual        Afternoon  \n",
       "4             Freehold     Talk Therapy            Individual        Afternoon  "
      ]
     },
     "execution_count": 94,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "id": "08007e3f-9190-498a-8d07-271a10dabc1d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['Talk Therapy', 'Medication Management'], dtype=object)"
      ]
     },
     "execution_count": 100,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['appointment_type'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "id": "5df7a7cd-196c-47a3-ad76-a1376e28f452",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['talk_therapy_type'] = df['talk_therapy_type'].fillna('ignore')\n",
    "therapy_dummies = pd.get_dummies(df['talk_therapy_type'], prefix = 'therapy')\n",
    "therapy_dummies = therapy_dummies[['therapy_Individual', 'therapy_Family', 'therapy_Couples', 'therapy_Bariatric Evaluation']].reindex(df.index,fill_value = 0)\n",
    "df['Medication Management'] = (df['appointment_type'] == 'Medication Management').astype(int)\n",
    "df = pd.concat([df, therapy_dummies], axis = 1)\n",
    "therapy_columns = ['therapy_Individual', 'therapy_Family', 'therapy_Couples', 'therapy_Bariatric Evaluation']\n",
    "df[therapy_columns] = df[therapy_columns].astype(int)\n",
    "df.drop(['appointment_type', 'talk_therapy_type'], axis = 1, inplace = True)  ##implemented one hot encoding to see the therapy type easier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "id": "ed662a8a-8f42-4dfe-b498-c643cd62e2bf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>intake_method</th>\n",
       "      <th>referer</th>\n",
       "      <th>age</th>\n",
       "      <th>town</th>\n",
       "      <th>insurance_carrier</th>\n",
       "      <th>appointment_location</th>\n",
       "      <th>appointment_time</th>\n",
       "      <th>Medication Management</th>\n",
       "      <th>therapy_Individual</th>\n",
       "      <th>therapy_Family</th>\n",
       "      <th>therapy_Couples</th>\n",
       "      <th>therapy_Bariatric Evaluation</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Call</td>\n",
       "      <td>Bariatric Doctor</td>\n",
       "      <td>27.5</td>\n",
       "      <td>Elizabeth</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Virtual</td>\n",
       "      <td>Evening</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Call</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>12.5</td>\n",
       "      <td>Summit</td>\n",
       "      <td>United Healthcare</td>\n",
       "      <td>Virtual</td>\n",
       "      <td>Afternoon</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>22.5</td>\n",
       "      <td>Monroe</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Afternoon</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>27.5</td>\n",
       "      <td>Ocean</td>\n",
       "      <td>BCBS</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Afternoon</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Boom Form</td>\n",
       "      <td>Family/Friend</td>\n",
       "      <td>32.5</td>\n",
       "      <td>Jackson</td>\n",
       "      <td>Aetna</td>\n",
       "      <td>Freehold</td>\n",
       "      <td>Afternoon</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  intake_method           referer   age       town  insurance_carrier  \\\n",
       "0          Call  Bariatric Doctor  27.5  Elizabeth               BCBS   \n",
       "1          Call     Family/Friend  12.5     Summit  United Healthcare   \n",
       "2     Boom Form     Family/Friend  22.5     Monroe               BCBS   \n",
       "3     Boom Form     Family/Friend  27.5      Ocean               BCBS   \n",
       "4     Boom Form     Family/Friend  32.5    Jackson              Aetna   \n",
       "\n",
       "  appointment_location appointment_time  Medication Management  \\\n",
       "0              Virtual          Evening                      0   \n",
       "1              Virtual        Afternoon                      0   \n",
       "2             Freehold        Afternoon                      0   \n",
       "3             Freehold        Afternoon                      0   \n",
       "4             Freehold        Afternoon                      0   \n",
       "\n",
       "   therapy_Individual  therapy_Family  therapy_Couples  \\\n",
       "0                   0               0                0   \n",
       "1                   1               0                0   \n",
       "2                   1               0                0   \n",
       "3                   1               0                0   \n",
       "4                   1               0                0   \n",
       "\n",
       "   therapy_Bariatric Evaluation  \n",
       "0                             1  \n",
       "1                             0  \n",
       "2                             0  \n",
       "3                             0  \n",
       "4                             0  "
      ]
     },
     "execution_count": 108,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2def6a88-da3a-4832-b470-089b97e92bf4",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
